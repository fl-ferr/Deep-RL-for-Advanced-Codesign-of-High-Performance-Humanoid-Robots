\chapter*{Prologue}
\label{chp:00-Prologue}

\section*{Motivation and Objectives}
\CarlottaSays{General Comments 
\begin{itemize}
    \item You are continuously changing in between motion intelligence/emboidied  cognintion/performances/ energy efficiency without connecting these topics (that are not synonymous) this causes confusion, try to be coherent and introduce and explain one concept at the time and be coherent throughout the text.
    \item \st{The paragraph are wrong.  You should start a new paragraph with a brand new topic, therefore it is impossible that words as thus, however etc start a new paragraph. this should stay with the previous paragraph}
    \item  I put some comments to identify where the reader gets confused, but I suggest you to read some papers introduction to get the idea and try to rewrite the prologue 
    \item missing  references, a lot of references are misplaced. What you say in this part should be a correctly supported by the SoA 
\end{itemize}}
Robots are often associated with their capacity to move and interact with the environment, navigating through complex environments, picking up objects, and performing various tasks in a wide range of applications \CarlottaSays{\st{Would be good to add a reference here }}. The field of robotics has been rapidly evolving in recent years, with robots becoming increasingly aware of their surroundings and behaving accordingly, eventually becoming more capable of performing complex tasks. This process, known as motion intelligence or embodied cognition \CarlottaSays{\st{Embodied cognition and motion intelligence are two different things, motion intelligence refers to the ability of robot to behave intelligently, meanwhile embodied cognition refers to an intelligence which is embodied in the  robot/animal whatever itself. Embodied intelligence is a term that comes from Cognitive Science filed. For giving you an idea, codesign is a way in which we can endow robot with embodied intelligence}}, involves the development of algorithms that enable robots to perform tasks autonomously and receive and process information coming from the environment and most of all from their own body. The most common approach to achieve this is to use a combination of sensors and algorithms to enable the robot to perceive its movements and make decisions based on that data \citep{metta_icub_2008}.\CarlottaSays{\st{This citation presents the robot icub rather than talking about the approach of obtaining embodied cognition}}

\CarlottaSays{\st{This should \textbf{not} be a new paragraph}} However, the morphological and physical properties of a robot's hardware are sometimes overlooked  \CarlottaSays{\st{If we are considering the sensors, we are somehow considering the hardware of the robot, thus this sentence is in contrast with the afore one}} during the development of these control systems \CarlottaSays{\st{Till now we have talked about motion intelligence, control systems have not been associated to motion intelligence}}, as mainly provided by the manufacturer, and the research is focused on the development of the robot's motion intelligence. However, the robot's hardware plays a pivotal role in achieving energy efficiency and effectiveness for a set of tasks \CarlottaSays{\st{I will stay more general, for achieving effectively the tackle task or something similar}}.
In such cases \CarlottaSays{\st{Which cases?} }, the design of the robot's software and algorithms may not consider how the body can be optimized for specific tasks, potentially leading to inefficiencies and limitations in the robot's performance. \CarlottaSays{\st{Key argument but not clear, what do you mean that the algorithm should consider how the robot can be optimized? it seems something like: the control should now that the hardware can be optimized with non linear tenciques, but that is not the point}} Conversely when engineers \CarlottaSays{\st{Why should only be engineers?} } design the physical structure of the robot, they may not always take into account the specific tasks the robot is meant to perform\CarlottaSays{\st{Both the task and how the robot will perform the task}}. The lack of alignment between the robot's hardware and its intended functions can result in suboptimal designs that hinder the robot's performance in real-world applications \citep{vaisi_review_2022, sartore_optimization_2022} \CarlottaSays{\st{This citation refer to the optimization of hardware, meanwhile, you are citing them as a reference for suboptimal design}}.

\CarlottaSays{\st{This should \textbf{not} a new paragraph}}Thus, taking a comprehensive perspective on the robot's performance and energy efficiency \CarlottaSays{Why now we are talking about performances and energy efficiency?} requires an in-depth examination of both its hardware and control system. This approach can be crucial because it involves leveraging the inherent characteristics of the robot's physical design to optimize its efficiency and effectiveness for a set of given tasks \CarlottaSays{\st{This sentence does not say actually anything}}. By doing so \CarlottaSays{Is not clear what is this so}, we can substantially reduce the forces and torques\CarlottaSays{Why are we talking about forces and torques now? This is not behavior oriented } required for task completion, a particularly critical aspect for battery-powered robots \CarlottaSays{Why are we talking about battery powered? }. Furthermore, this holistic \CarlottaSays{What is this approach ? Why is holistic ? Be more clear about what you are referring to} approach aims to not only minimize energy consumption but also to maximize the robot's performance metrics, including speed, accuracy, and robustness, ensuring that it operates at peak efficiency \CarlottaSays{This is not clear what are you referring about}.
With this new approach \CarlottaSays{Which new approach? }, the robot's body is not just a passive component but an active part of the control system loop, and the control system is not just a set of algorithms but a key parameter in the robot morphology design. This concept is commonly referred to as \textit{codesign}. \CarlottaSays{Codesign is a key aspect, but is introduced with a sentence that is vague rather than direct}

\CarlottaSays{Until here, you have said the main concepts several times but in a vague and confusing way, try to go to the point, you should have clear what you would like to convey to the reader e.g. 
\begin{itemize}
    \item Robots needs to be able to do various sets of task efficiently because .... 
    \item Right now the robot's control and design are developed separately leading to suboptimal solutions;
    \item The hardware and control synergy makes a being show intelligent behavior w.r.t the task; 
    \item Hardware and control should also be optimized together in robotics to achieve the foreseen level of intelligence i,e. codesign; 
    \item In the SoA this codesign have been tackled in several way, etc ... 
    \item Lately the usage of hardware accelerated simulator made RL possible and fast 
    \item We propose .. 
\end{itemize}
In the SOA you should underline the pros and the cons of the works you presented, leading the reader to your contribution that fit the identified hole in the SoA.
If you look at what you wrote, some of these concepts are there but hidden and not connected. You should try to guide the reader to the contribution.}

When dealing with humanoid robotics, the intricacy of feature engineering \CarlottaSays{\st{What is feature engineering ? }} is often time-consuming, hardly flexible, and might lead to sub-optimal assets. Furthermore, the complexity given by the realistic multibody dynamics involving friction, contacts, elasticity, and gravity might lead to poor results when there is a need for the robot to adapt to new scenarios\CarlottaSays{Why? What are we talking about here ? sim to gap ? not leave the reader to guess}. This combination of factors makes it challenging to design a robot that can perform a wide range of tasks in a variety of environments and using classical optimization approaches might become infeasible. In recent years, the field of robotics has been propelled by the combination of artificial intelligence and mechanical design \citep{fadini_simulation_2022}. \CarlottaSays{\st{This paper uses genetic algorithm, AI is vague for a scientific manuscript} } Such fusion pushed the frontiers of applications that led to a rapid increase in the need to face progressively harder challenges and tasks.\CarlottaSays{\st{Too complex and pretensious word but there is not an actual meaning}}
Picture a robot capable of physically interacting with objects, learning complex and robust human-like walking, and effortlessly adapting to novel scenarios without explicit design for those new tasks. \CarlottaSays{Are we talking about SoA ? THis is not SoA related but more introduction}
These visions require a holistic approach to the design of the robot, where there is no need to explicitly formulate the dynamics of the robot,\CarlottaSays{That is not always true, are different techniques each with its pros and cons, try not to be black and white unless you have a paper to cite } but rather to let the robot learn how to move and interact with the environment by itself using the available sensors and actuators. That is why the application of deep reinforcement learning (\ac{RL}) to robotics has been gaining momentum in recent years \citep{golroudbari_recent_2023,li_reinforcement_2021}.\CarlottaSays{This is too vague still, this is SoA, try to be  direct on how what and which are the hypothesis in the papers}

Previous attempts at codesign \CarlottaSays{We ar eback to codesign but before we were talking about RL and before before about codesign} for robotics have been made considering an environment with limited complexity, such as a 2D plane \citep{ha_reinforcement_2019}, optimizing simplified hardware with a limited number of links \citep{chen_hardware_2020} or avoiding retraining the neural network (\ac{NN})-model at each optimizer iteration \citep{bjelonic_learning-based_2023}, potentially leading to a sub-optimality propagation \CarlottaSays{\st{Of What}} throughout the whole design process. Though taking into account the whole-body dynamics of a humanoid robot can result in a more realistic and accurate model, it requires high computational power and time, making it difficult to use in a codesign loop.\CarlottaSays{Citation ? } That is why it has not been widely investigated in the field of codesign for robotics. Yet, with the use of hardware acceleration, it is possible to optimize the computational effort required reducing the time needed for the simulation. \CarlottaSays{Missing citations, missing explanation of what hardware acceleration is, this is one keypoint of you thesis, it should be clear to the reader what it is}

In light of the limitations identified in previous codesign efforts, which often operated within simplified environments and models\CarlottaSays{A reader does not have clear this hole you are referring to now, you have talked about learning, ai, model free and model bases but it is not clear where the simplified model arrives }, this work aims to explore a novel approach, trying to overcome the challenges of codesign  \CarlottaSays{For humanoid robots } by exploiting the capabilities of modern hardware-accelerated architectures as a support of a codesign loop combining genetic algorithms (\ac{GA})\CarlottaSays{Reference missing} and deep reinforcement learning.

% In essence, achieving optimal performance and energy efficiency in robotics requires a holistic approach. It's not just about making a robot smart but also crafting a body that aligns with its intended tasks. By considering both the robot control system and hardware together, we can create robots that are not only intelligent but also proficient in their actions.


\section*{Contributions}

The main contributions of this work can be summarized as follows:

\begin{enumerate}
    \item An in-depth analysis and enhancement of a differentiable physics simulator, with a focus on contact dynamics and forward dynamics computation.
    \item A motor dynamics conditioned formulation for the forward dynamics of a rigid multibody system with the use of recursive propagation methods.
    \item A co-optimization framework for the codesign of humanoid robots, that exploits the potential of deep reinforcement learning and genetic algorithms, supported by hardware acceleration.
    \item A set of experiments that demonstrate the effectiveness and the limitations of the proposed framework.
\end{enumerate}


\subsection*{Outline}

The present work is organized as follows:

\begin{description}

    \item{\hyperref[part:background]{Part I: Background}}

          \begin{description}
              \item[{\hyperref[chp:back_RBDynamics]{In the first chapter}}] The mathematical foundations of rigid body dynamics are presented, along with the notation and the conventions that are used throughout the work.
              \item[{\hyperref[chp:back_PhysicsSimulators]{In the second chapter}}] The current panorama of physics simulators is presented, with a focus on the differentiable simulators and in particular on the one exploited and modified for the purpose of this work.
              \item [{\hyperref[chp:back_RLGA]{In the third chapter}}] The fundamentals of reinforcement learning and evolutionary algorithms are presented, with a focus on the algorithms and the techniques that are exploited in the codesign loop.
          \end{description}

    \item{\hyperref[part:contributions]{Part II: Contributions}}

          \begin{description}
              \item[{\hyperref[chp:contrib_ABA]{In the fourth chapter}}] The implementation of a recursive rigid body dynamics algorithm that takes into account motor dynamics is presented, along with the details regarding its implementation in a hardware-accelerated simulator.
              \item[{\hyperref[chp:contrib_CodesignRL]{In the fifth chapter}}] The state of the art in the field of codesign and reinforcement learning is presented, furthermore the methods and the main challenges of the implementation of a complete codesign framework that exploits the potential of reinforcement learning and genetic algorithms are discussed.
              \item[{\hyperref[chp:contrib_ResultsDiscussion]{In the sixth chapter}}] The results of the experiments are presented and discussed, with a focus on the analysis of the performance of the different algorithms and the comparison between the different approaches.
              \item[{\hyperref[chp:contrib_Conclusions]{In the last chapter}}] The conclusions of the present work are drawn, with an eye on future developments and the potential applications of the proposed framework.
          \end{description}
\end{description}