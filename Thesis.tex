% A LaTeX template for MSc Thesis submissions to 
% Politecnico di Milano (PoliMi) - School of Industrial and Information Engineering
%
% S. Bonetti, A. Gruttadauria, G. Mescolini, A. Zingaro
% e-mail: template-tesi-ingind@polimi.it
%
% Last Revision: October 2021
%
% Copyright 2021 Politecnico di Milano, Italy. NC-BY

\documentclass{Configuration_Files/PoliMi3i_thesis}

%------------------------------------------------------------------------------
%	REQUIRED PACKAGES AND  CONFIGURATIONS
%------------------------------------------------------------------------------

% CONFIGURATIONS
\usepackage{parskip} % For paragraph layout
\usepackage{setspace} % For using single or double spacing
\usepackage{emptypage} % To insert empty pages
\usepackage{multicol} % To write in multiple columns (executive summary)
\setlength\columnsep{15pt} % Column separation in executive summary
\setlength\parindent{0pt} % Indentation
\addtolength{\skip\footins}{5pt} % Footnote separation from text
\setlength{\footnotesep}{2ex} % Footnote separation
\raggedbottom  

% PACKAGES FOR TITLES
\usepackage{titlesec}
% \titlespacing{\section}{left spacing}{before spacing}{after spacing}
\titlespacing{\section}{0pt}{3.3ex}{2ex}
\titlespacing{\subsection}{0pt}{3.3ex}{1.65ex}
\titlespacing{\subsubsection}{0pt}{3.3ex}{1ex}
\usepackage{color}

% PACKAGES FOR LANGUAGE AND FONT
\usepackage[english]{babel} % The document is in English  
\usepackage[utf8]{inputenc} % UTF8 encoding
\usepackage[T1]{fontenc} % Font encoding 
\usepackage[11pt]{moresize} % Big fonts

% PACKAGES FOR IMAGES
\usepackage{graphicx}
\usepackage{transparent} % Enables transparent images
\usepackage{eso-pic} % For the background picture on the title page
\usepackage{subfig} % Numbered and caption subfigures using \subfloat.
\usepackage{tikz} % A package for high-quality hand-made figures.
\usetikzlibrary{}
\graphicspath{{./Images/}} % Directory of the images
\usepackage{caption} % Coloured captions
\usepackage{xcolor} % Coloured captions
\usepackage{amsthm,thmtools,xcolor} % Coloured "Theorem"
\usepackage{float}

% STANDARD MATH PACKAGES
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{mathtools}
\usepackage{bm}
\usepackage[overload]{empheq} % For braced-style systems of equations.
\usepackage{fix-cm} % To override original LaTeX restrictions on sizes

% PACKAGES FOR TABLES
\usepackage{tabularx}
\usepackage{longtable} % Tables that can span several pages
\usepackage{colortbl}

% PACKAGES FOR ALGORITHMS (PSEUDO-CODE)
\usepackage[
  noEnd=true,
  indLines=true,
  italicComments=true,
  rightComments=true,
]{algpseudocodex}
\usepackage{algorithm}

% PACKAGES FOR REFERENCES & BIBLIOGRAPHY
\usepackage[colorlinks=true,linkcolor=black,anchorcolor=black,citecolor=black,filecolor=black,menucolor=black,runcolor=black,urlcolor=webbrown]{hyperref} % Adds clickable links at references
\usepackage[capitalise,noabbrev]{cleveref}
\usepackage[authoryear,square]{natbib} % Square brackets, citing references with numbers, citations sorted by appearance in the text and compressed
\setcitestyle{aysep={,},citesep={,},yysep={,}}
\bibliographystyle{abbrvnat} % You may use a different style adapted to your field

% OTHER PACKAGES
\usepackage{pdfpages} % To include a pdf file
\usepackage{afterpage}
\usepackage{fancyhdr} % For the headers
\fancyhf{}

% Input of configuration file. Do not change config.tex file unless you really know what you are doing. 
\input{Configuration_Files/config}

%----------------------------------------------------------------------------
%	NEW COMMANDS DEFINED
%----------------------------------------------------------------------------
\DeclareMathAlphabet{\mathbbm}{U}{BOONDOX-ds}{m}{n}
%----------------------------------------------------------------------------
%	ADD YOUR PACKAGES (be careful of package interaction)
%----------------------------------------------------------------------------
\usepackage[footnote, smaller]{acronym}
\usepackage{ifthen}
\usepackage{nomencl}
\makenomenclature
\renewcommand\nomgroup[1]{%
\item[\bfseries
\ifthenelse{\equal{#1}{D}}{Rigid Body Dynamics}{%
\ifthenelse{\equal{#1}{R}}{Reinforcement Learning}{%
\ifthenelse{\equal{#1}{M}}{Mathematical Notation}{}}}%
]}
\usepackage[bb=ams]{mathalfa}
\usepackage{booktabs}
\usepackage{soul}
\usepackage{tikz-3dplot}
\usetikzlibrary{positioning}

\usepackage{xspace}
\usepackage[babel=true,tracking=true]{microtype}
\usepackage{calc} 
\usepackage{enumitem}
%----------------------------------------------------------------------------
%	ADD YOUR DEFINITIONS AND COMMANDS (be careful of existing commands)
%----------------------------------------------------------------------------
\definecolor{webgreen}{rgb}{0,.5,0}
\definecolor{webbrown}{rgb}{.6,0,0}
\newcommand{\CarlottaSays}[1]{\textcolor{blue}{\textbf{Carlotta:} #1}}
\newcommand{\StefanoSays}[1]{\textcolor{orange}{\textbf{Stefano:} #1}}
\newcommand{\DanieleSays}[1]{\textcolor{red}{\textbf{Daniele:} #1}}
\newcommand{\SilvioSays}[1]{\textcolor{green}{\textbf{Silvio:} #1}}

\newcommand{\cpp}{C\texttt{++}\xspace}
\newcommand{\jax}{\textsc{jax}~}
\newcommand{\jaxsim}{\textsc{jax}sim~}
%----------------------------------------------------------------------------
%	BEGIN OF YOUR DOCUMENT
%----------------------------------------------------------------------------

\begin{document}

\fancypagestyle{plain}{%
    \fancyhf{} % Clear all header and footer fields
    \fancyhead[RO,RE]{\thepage} %RO=right odd, RE=right even
    \renewcommand{\headrulewidth}{0pt}
    \renewcommand{\footrulewidth}{0pt}}

%----------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------

\pagestyle{empty} % No page numbers
\frontmatter % Use roman page numbering style (i, ii, iii, iv...) for the preamble pages

\puttitle{
    title=Hardware Accelerated Simulators for Humanoid Robot Codesign via Deep Reinforcement Learning, % Title of the thesis
    name=Filippo Luca Ferretti, % Author Name and Surname
    course=Mechanical Engineering - Ingegneria Meccanica, % Study Programme (in Italian)
    ID  = 994428,  % Student ID number (numero di matricola)
    advisor= {Prof. Francesco Braghin, Dr. Daniele Pucci},% Supervisor name
    coadvisor={Carlotta Sartore, Dr. Stefano Dafarra}, % Co-Supervisor name, remove this line if there is none
    academicyear={2022-23},  % Academic Year
} % These info will be put into your Title page 

%----------------------------------------------------------------------------
%	PREAMBLE PAGES: ABSTRACT (inglese e italiano), EXECUTIVE SUMMARY
%----------------------------------------------------------------------------
\startpreamble
\setcounter{page}{1} % Set page counter to 1

% ABSTRACT IN ENGLISH
\chapter*{Abstract}
The hardware design is often treated as an immutable component in the development of a control strategy, which is usually the main focus of the research.
Moreover, the intricacy of the control systems and the complexity reached by certain tasks that the robots are required to perform, make the control design
challenging, with potential limitation on the adaptability to new scenarios. In order to maximize the performance with respect to a given task,
designing the robot morphology together with its control systems in an extensive approach is a promising solution.
The thesis aims to target the problem of a synergic design of humanoid robots and their control systems. In particular, the present work aims
to develop a framework for the codesign of humanoid robots that combines the use of deep reinforcement learning and evolutionary algorithms.
The simulation required during the generation of synthetic data in the reinforcement learning phase is computationally expensive, hence it
emerges the need for an architecture that allows to speed up the simulation, involving the use of hardware accelerations via simulators that exploit the use of Graphical Processing Units (GPUs) and Tensor Processing Units (TPUs). The thesis tackles the
problem of having an algorithm able to compute the dynamics taking into account the presence of the motors, which represent the optimization
variables of interest in this scenario, with their gear ratio, inertia and internal friction. Then, a framework for the codesign of humanoid robots,
supported by hardware accelerations, is developed and thouroughly tested on a simple, yet easily scalable, task. The results show that the proposed
framework is able to generate a motor set that is able to maximize the performance of the robot in the given task.
\\
\\
\textbf{Keywords:} codesign, hardware accelerations, reinforcement learning, evolutionary algorithm, forward dynamics % Keywords

% ABSTRACT IN ITALIAN
\chapter*{Abstract in lingua italiana}
Nel campo della robotica umanoide, i robot stanno diventando sempre più standardizzati a causa della rapida espansione del settore e dell'aumento
delle applicazioni. Questa tendenza rende il design hardware un elemento cruciale nello sviluppo della strategia di controllo, che spesso rappresenta
il fulcro della ricerca. La complessità sia dei sistemi di controllo sia dei compiti che i robot devono affrontare rende la progettazione di tali
sistemi un'impresa impegnativa, con possibili limitazioni nell'adattabilità a nuovi scenari. Per ottenere prestazioni ottimali in determinati compiti,
un approccio promettente consiste nel progettare la morfologia del robot in modo integrato insieme ai suoi sistemi di controllo.

La tesi si pone l'obiettivo di affrontare la sfida del design sinergico dei robot umanoidi insieme ai loro sistemi di controllo. In questo lavoro, si
intende sviluppare un framework per il co-design dei robot umanoidi, unendo l'utilizzo del deep reinforcement learning con gli algoritmi evolutivi.
Dato che la simulazione richiesta per generare dati sintetici nell'apprendimento tramite rinforzo è computazionalmente dispendiosa, è necessaria
un'architettura che acceleri tale processo, coinvolgendo l'utilizzo di accelerazioni hardware tramite simulatori che sfruttino le Unità di Elaborazione Grafica
(GPU) e Tensoriale (TPU). A questo scopo, la tesi si concentra dapprima sullo sviluppo di un algoritmo in grado di calcolare la dinamica considerando la
presenza dei motori, variabili ottimizzabili in questo contesto, in riferimento al loro rapporto di trasmissione, inerzia e attrito viscoso interno.
Successivamente, verrà sviluppato e testato un framework per il co-design di robot umanoidi, supportato da accelerazioni hardware, concentrandosi su un
compito relativamente semplice, ma facilmente scalabile. I risultati evidenzieranno la capacità del framework proposto nel generare un set di motori
che massimizzano le prestazioni del robot nel compito assegnato.
\\
\\
\textbf{Parole chiave:} codesign, accelerazione hardware, apprendimento per rinforzo, algoritmi evolutivi, dinamica diretta % Keywords (italian)

%----------------------------------------------------------------------------
%	LIST OF CONTENTS/FIGURES/TABLES/SYMBOLS
%----------------------------------------------------------------------------

% TABLE OF CONTENTS
\thispagestyle{empty}
\tableofcontents % Table of contents 
\thispagestyle{empty}
\cleardoublepage

\include{Front_Back_Matter/Acronym}
\include{Front_Back_Matter/Symbols}

%-------------------------------------------------------------------------
%	THESIS MAIN TEXT
%-------------------------------------------------------------------------

\addtocontents{toc}{\vspace{2em}} % Add a gap in the Contents, for aesthetics
\mainmatter % Begin numeric (1,2,3...) page numbering

% --------------------------------------------------------------------------
% NUMBERED CHAPTERS % Regular chapters following
% --------------------------------------------------------------------------

\include{Chapters/00-Prologue}

\part{Background}\label{part:background}
\include{Chapters/Background/01-RBDynamics}
\include{Chapters/Background/02-PhysicsSimulators}
\include{Chapters/Background/03-RLGA}

\part{Contributions}\label{part:contributions}
\include{Chapters/Contributions/04-ABA}
\include{Chapters/Contributions/05-CodesignRL}
\include{Chapters/Contributions/06-ResultsDiscussion}
\include{Chapters/Contributions/07-Conclusions}

\include{Chapters/99-Epilogue}
%-------------------------------------------------------------------------
%	BIBLIOGRAPHY
%-------------------------------------------------------------------------

\addtocontents{toc}{\vspace{2em}} % Add a gap in the Contents, for aesthetics
\bibliography{references}

%-------------------------------------------------------------------------
%	APPENDICES
%-------------------------------------------------------------------------

\cleardoublepage
\addtocontents{toc}{\vspace{2em}} % Add a gap in the Contents, for aesthetics
\appendix
\include{Front_Back_Matter/AppendixA}

% LIST OF FIGURES
\listoffigures

% LIST OF TABLES
\listoftables

% LIST OF SYMBOLS
% Write out the List of Symbols in this page
% \chapter*{List of Symbols} % You have to include a chapter for your list of symbols (
% \begin{table}[H]
%     \centering
%     \begin{tabular}{lll}
%         \textbf{Variable} & \textbf{Description} & \textbf{SI unit} \\\hline\\[-9px]
%         $\bm{u}$ & solid displacement & m \\[2px]
%         $\bm{u}_f$ & fluid displacement & m \\[2px]
%     \end{tabular}
% \end{table}

% ACKNOWLEDGEMENTS
\chapter*{Acknowledgements}
Here you might want to acknowledge someone.


\cleardoublepage

\end{document}
